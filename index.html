<!DOCTYPE html>
<html lang="en" >
<head>
  	<meta charset="UTF-8">
  	<title>31262 - Final Graphics Project</title>
	<link href="https://fonts.googleapis.com/css?family=Saira" rel="stylesheet"><link rel="stylesheet" href="./style.css">

</head>
<body>
	<div id="content">
    
		<label for="thefile" class="file"> Choose an audio file
		  <input type="file" id="thefile" accept="audio/*" />
		</label>

		
	
		<audio id="audio" controls></audio>
		<div id="out"></div>
	</div>


<!-- partial -->
<script src='js/three.min.js'></script>
<script src="js/dat.gui.min.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/simplex-noise/2.3.0/simplex-noise.min.js'></script>
<script src="js/TweenMax.min.js"></script>
<script src="./FinalProject.js"></script>
<script src="js/PLYLoader.js"></script>

<script src="js/EffectComposer.js"></script>

<script src="js/RenderPass.js"></script>
<script src="js/ShaderPass.js"></script>
<!--
-->
<script src="js/GlitchPass.js"></script>

<!--
<script src="js/GLTFLoader.js"></script>
-->


<script type="x-shader/x-vertex" id="tvstatic_vertexShader">
	#define GLSLIFY 1
	// Texture varyings
	varying vec2 v_uv;
	
	/*
	 * The main program
	 */
	void main() {
		// Calculate the varyings
		v_uv = uv;
	
		// Vertex shader output
		gl_Position = vec4(position, 1.0);
	}
</script>

<script type="x-shader/x-fragment" id="tvstatic_fragmentShader">
#define GLSLIFY 1
//Common uniforms
uniform vec2 u_resolution;
uniform vec2 u_mouse;
uniform float u_time;
uniform float u_frame;

// Texture uniforms
uniform sampler2D u_texture;

// Texture varyings
varying vec2 v_uv;

highp float random1d(float dt) {
    highp float c = 43758.5453;
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

highp float noise1d(float value) {
	highp float i = floor(value);
	highp float f = fract(value);
	return mix(random1d(i), random1d(i + 1.0), smoothstep(0.0, 1.0, f));
}

highp float random2d(vec2 co) {
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy, vec2(a, b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
	// Calculate the effect relative strength
	float strength = (0.3 + 0.7 * noise1d(0.3 * u_time)) * u_mouse.x / u_resolution.x;

	// Calculate the effect jump at the current time interval
	float jump = 500.0 * floor(0.3 * (u_mouse.x / u_resolution.x) * (u_time + noise1d(u_time)));

	// Shift the texture coordinates
	vec2 uv = v_uv;
	uv.y += 0.2 * strength * (noise1d(5.0 * v_uv.y + 2.0 * u_time + jump) - 0.5);
	uv.x += 0.1 * strength * (noise1d(100.0 * strength * uv.y + 3.0 * u_time + jump) - 0.5);

	// Get the texture pixel color
	vec3 pixel_color = texture2D(u_texture, uv).rgb;

	// Add some white noise
	pixel_color += vec3(5.0 * strength * (random2d(v_uv + 1.133001 * vec2(u_time, 1.13)) - 0.5));

	// Fragment shader output
	gl_FragColor = vec4(pixel_color, 1.0);
}
</script>

<!--
<script type="x-shader/x-vertex" id="rgbshift_vertexShader">

	#define GLSLIFY 1
	// Texture varyings
	varying vec2 v_uv;

	/*
	* The main program
	*/
	void main() {
		// Calculate the varyings
		v_uv = uv;

		// Vertex shader output
		gl_Position = vec4(position, 1.0);
	}
</script>

<script type="x-shader/x-fragment" id="rgbshift_fragmentShader">
	#define GLSLIFY 1
	// Common uniforms
	uniform vec2 u_resolution;
	uniform vec2 u_mouse;
	uniform float u_time;
	uniform float u_frame;

	// Texture uniforms
	uniform sampler2D u_texture;

	// Texture varyings
	varying vec2 v_uv;

	/*
	* The main program
	*/
	void main() {
		// Calculate the color offset directions
		float angle = u_time;
		vec2 red_offset = vec2(cos(angle), sin(angle));
		angle += radians(120.0);
		vec2 green_offset = vec2(cos(angle), sin(angle));
		angle += radians(120.0);
		vec2 blue_offset = vec2(cos(angle), sin(angle));

		// Calculate the offset size as a function of the pixel distance to the center
		float offset_size = 0.1 * length(gl_FragCoord.xy - 0.5 * u_resolution);

		// Scale the offset size by the relative mouse position
		offset_size *= u_mouse.x / u_resolution.x;

		// Extract the pixel color values from the input texture
		float red = texture2D(u_texture, v_uv - offset_size * red_offset / u_resolution).r;
		float green = texture2D(u_texture, v_uv - offset_size * green_offset / u_resolution).g;
		float blue = texture2D(u_texture, v_uv - offset_size * blue_offset / u_resolution).b;

		// Fragment shader output
		gl_FragColor = vec4(red, green, blue, 1.0);
	}
</script>
-->







</body>
</html>
